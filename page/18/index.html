<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://assz0a.coding-pages.com').hostname,
    root: '/',
    scheme: 'Pisces',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="学习笔记">
<meta property="og:url" content="http://assz0a.coding-pages.com/page/18/index.html">
<meta property="og:site_name" content="学习笔记">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="学习笔记">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://assz0a.coding-pages.com/page/18/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>学习笔记</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">学习笔记</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">95</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">5</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">191</span></a>

  </li>
        <li class="menu-item menu-item-tools">

    <a href="/tools" rel="section"><i class="fa fa-fw fa-wrench"></i>Tools</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/calendar" rel="section"><i class="fa fa-fw fa-calendar"></i>日程表</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2020/09/21/streetmap/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="学习笔记">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/21/streetmap/" class="post-title-link" itemprop="url">OpenStreetMap开源高精度海岸线数据介绍</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-21 21:05:08" itemprop="dateCreated datePublished" datetime="2020-09-21T21:05:08+08:00">2020-09-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-10 23:18:25" itemprop="dateModified" datetime="2024-06-10T23:18:25+08:00">2024-06-10</time>
              </span>

          
            <span id="/2020/09/21/streetmap/" class="post-meta-item leancloud_visitors" data-flag-title="OpenStreetMap开源高精度海岸线数据介绍" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/09/21/streetmap/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/21/streetmap/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="OpenStreetMap"><a href="#OpenStreetMap" class="headerlink" title="OpenStreetMap"></a>OpenStreetMap</h2><p>OpenStreetMap（简称OSM）是一个网上地图协作计划，目标是创造一个内容自由且能让所有人编辑的世界地图。由于大众参与的持续修正以及采用了更加可靠的数据源，OSM的海岸线精度和分辨率比GMT开源岸线GSHHG更高。</p>
<p>German FOSSGIS（<a href="https://www.fossgis.de/）" target="_blank" rel="noopener">https://www.fossgis.de/）</a> 已经从OSM海岸线中制作了shapefile格式的文件，下载地址为<a href="https://osmdata.openstreetmap.de/data/land-polygons.html。" target="_blank" rel="noopener">https://osmdata.openstreetmap.de/data/land-polygons.html。</a> 注意下载WGS-84投影的<code>Large polygons not split</code>版本，文件大小约600M。下载后可以利用开源GIS软件QGIS软件快速打开数据集，并导出感兴趣的区域为文本格式，从而可以使用别的绘图软件进行绘图（如GMT）。</p>
<h2 id="使用QGIS提取区域shp"><a href="#使用QGIS提取区域shp" class="headerlink" title="使用QGIS提取区域shp"></a>使用QGIS提取区域shp</h2><p>下面是基本的数据选取和导出步骤。</p>
<ul>
<li>读入全球的shp文件</li>
<li>缩放到目标区域</li>
<li><code>toggle edit</code></li>
<li><code>Edit</code>-<code>Split feature</code>,绘制一条线分割出目标区域。</li>
<li>Select feature</li>
<li>save selected feature as shp</li>
</ul>
<p>如果是导出某一个闭合的多边形，如海岛，则不用分割，直接选择select feature，然后在layers中右键选择export-save selected feature as</p>
<p><code>如果想要导出一般海岛（或任意区域）的房屋、道路等信息，可以从https://www.openstreetmap.org 网站操作，缩放到感兴趣区域，然后点击左上角的Export，导出osm格式文件，使用QGIS打开后，可以转换为shp格式。</code></p>
<h2 id="shp转文本格式或者kml"><a href="#shp转文本格式或者kml" class="headerlink" title="shp转文本格式或者kml"></a>shp转文本格式或者kml</h2><p>保证已经安装GMT，然后命令行：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ogr2ogr</span> <span class="selector-tag">-f</span> <span class="selector-tag">OGR_GMT</span> <span class="selector-tag">sy</span><span class="selector-class">.gmt</span> <span class="selector-tag">sy</span><span class="selector-class">.shp</span></span><br><span class="line"><span class="selector-tag">gmt</span> <span class="selector-tag">gmt2kml</span> <span class="selector-tag">sy</span><span class="selector-class">.gmt</span>  <span class="selector-tag">-Wthick</span>,<span class="selector-tag">white</span> <span class="selector-tag">-Fl</span> &gt;<span class="selector-tag">sy</span><span class="selector-class">.kml</span></span><br></pre></td></tr></table></figure>

<h2 id="使用GMT导出GSHHG海岸线"><a href="#使用GMT导出GSHHG海岸线" class="headerlink" title="使用GMT导出GSHHG海岸线"></a>使用GMT导出GSHHG海岸线</h2><p>GMT可以绘制地图，也可以导出岸线数据，并基于岸线进行空间分析。下面是简单的岸线导出、绘图和转换代码。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ps</span>=example_border.<span class="keyword">ps</span></span><br><span class="line">gmt psbasemap  -JM4.<span class="number">5</span>i -K -Bag `gmt gmtinfo <span class="keyword">sy</span>.gmt -I0.<span class="number">000001</span>`&gt; $<span class="keyword">ps</span></span><br><span class="line">gmt pscoast -M -W1 -Df -R &gt;<span class="keyword">cn</span>.txt # -Df means full resolution</span><br><span class="line">gmt psxy -R -J <span class="keyword">cn</span>.txt -W0.<span class="number">4</span><span class="keyword">p</span>,<span class="keyword">red</span> -O -K&gt;&gt; $<span class="keyword">ps</span></span><br><span class="line">gmt psxy -R -J <span class="keyword">sy</span>.gmt -W0.<span class="number">8</span><span class="keyword">p</span>,black -O&gt;&gt; $<span class="keyword">ps</span></span><br><span class="line">gmt gmt2kml <span class="keyword">cn</span>.txt  -Wthick,white -Fl &gt;<span class="keyword">cn</span>.kml</span><br></pre></td></tr></table></figure>

<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><p><img src="/images/2.png" alt><br><img src="/images/3.png" alt></p>
<p>白线为GSHHG岸线，红线为OSM岸线。表明OSM更为准确，在一些对岸线精度较高的场景中可以使用OSM。</p>
<p>其他参考：<br>GMT提供了一个例子：<a href="https://docs.generic-mapping-tools.org/dev/gallery/ex51.html#example-51" target="_blank" rel="noopener">https://docs.generic-mapping-tools.org/dev/gallery/ex51.html#example-51</a><br>QGIS：<a href="https://www.qgis.org/en/site/" target="_blank" rel="noopener">https://www.qgis.org/en/site/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2020/09/03/proj/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="学习笔记">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/03/proj/" class="post-title-link" itemprop="url">PROJ 坐标转换的几个例子</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-03 08:08:27" itemprop="dateCreated datePublished" datetime="2020-09-03T08:08:27+08:00">2020-09-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-10 23:18:25" itemprop="dateModified" datetime="2024-06-10T23:18:25+08:00">2024-06-10</time>
              </span>

          
            <span id="/2020/09/03/proj/" class="post-meta-item leancloud_visitors" data-flag-title="PROJ 坐标转换的几个例子" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/09/03/proj/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/09/03/proj/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="PROJ-转ITRF地心坐标到经纬度"><a href="#PROJ-转ITRF地心坐标到经纬度" class="headerlink" title="PROJ 转ITRF地心坐标到经纬度"></a>PROJ 转ITRF地心坐标到经纬度</h2><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ echo <span class="number">4097216.6805</span>  <span class="number">4429119.0287</span> <span class="number">-2065771.3676</span> <span class="number">0</span> | cct -I +proj=cart +ellps=GRS80</span><br><span class="line"> <span class="number">47.2292116930</span>  <span class="number">-19.0183060232</span>     <span class="number">1552.9924</span>        <span class="number">0.0000</span></span><br></pre></td></tr></table></figure>

<h2 id="PROJ-转经纬度到ITRF地心坐标"><a href="#PROJ-转经纬度到ITRF地心坐标" class="headerlink" title="PROJ 转经纬度到ITRF地心坐标"></a>PROJ 转经纬度到ITRF地心坐标</h2> <figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ echo <span class="number">47.2292116930</span>  <span class="number">-19.0183060232</span>     <span class="number">1552.9924</span> <span class="number">0</span> | cct +proj=cart +ellps=GRS80</span><br><span class="line"><span class="number">4097216.6805</span>   <span class="number">4429119.0287</span>  <span class="number">-2065771.3676</span>        <span class="number">0.0000</span></span><br></pre></td></tr></table></figure>

<h2 id="文件的批量转换"><a href="#文件的批量转换" class="headerlink" title="文件的批量转换"></a>文件的批量转换</h2> <figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> $ cat points_xyz.dat | head</span><br><span class="line"><span class="number">2919786.0</span>        <span class="number">-5383745.0</span>      <span class="number">1774604.0</span></span><br><span class="line"><span class="number">4097216.6805</span>     <span class="number">4429119.0287</span>    <span class="number">-2065771.3676</span></span><br><span class="line"><span class="number">6347491.3770</span>     <span class="number">-22944.8191</span>     <span class="number">622823.1488</span></span><br><span class="line"><span class="number">4913652.948</span>      <span class="number">3945922.493</span>     <span class="number">995383.145</span></span><br><span class="line">+<span class="number">2765120.9</span>       <span class="number">-4449250.25</span>     <span class="number">-3626405.6</span></span><br><span class="line"><span class="number">-3530185.489</span>     <span class="number">4118797.337</span>     <span class="number">3344036.931</span></span><br><span class="line"><span class="number">4696990.000</span>      <span class="number">723994.000</span>      <span class="number">4239678.000</span></span><br><span class="line"><span class="number">-2341332.8840</span>    <span class="number">-3539049.5090</span>   <span class="number">4745791.3600</span></span><br><span class="line"><span class="number">918129.40</span>        <span class="number">-4346071.20</span>     <span class="number">4561977.80</span></span><br><span class="line"><span class="number">-4052051.767</span>     <span class="number">4212836.215</span>     <span class="number">-2545106.027</span></span><br><span class="line"></span><br><span class="line"> $ cat points_xyz.dat | cct -I +proj=cart +ellps=GRS80 | head</span><br><span class="line"><span class="number">-61.5275339092</span>   <span class="number">16.2622989639</span>      <span class="number">-25.6724</span>           inf</span><br><span class="line"> <span class="number">47.2292116930</span>  <span class="number">-19.0183060232</span>     <span class="number">1552.9924</span>           inf</span><br><span class="line"> <span class="number">-0.2071110447</span>    <span class="number">5.6414771807</span>       <span class="number">83.4568</span>           inf</span><br><span class="line"> <span class="number">38.7663016596</span>    <span class="number">9.0351340011</span>     <span class="number">2439.1542</span>           inf</span><br><span class="line"><span class="number">-58.1398674816</span>  <span class="number">-34.8737126913</span>       <span class="number">42.0708</span>           inf</span><br><span class="line"><span class="number">130.5995927060</span>   <span class="number">31.8240613970</span>      <span class="number">314.6402</span>           inf</span><br><span class="line">  <span class="number">8.7626079453</span>   <span class="number">41.9274508625</span>       <span class="number">98.7752</span>           inf</span><br><span class="line"><span class="number">-123.4874696602</span>   <span class="number">48.3897817140</span>       <span class="number">31.7442</span>           inf</span><br><span class="line"><span class="number">-78.0713675911</span>   <span class="number">45.9558003990</span>      <span class="number">200.8294</span>           inf</span><br><span class="line"><span class="number">133.8855132190</span>  <span class="number">-23.6701238732</span>      <span class="number">603.3581</span>           inf</span><br></pre></td></tr></table></figure>
<p> 注意到第四列是时间信息，如果文件中缺少，则转换结果中提示<code>inf</code>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2020/08/16/GAT/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="学习笔记">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/16/GAT/" class="post-title-link" itemprop="url">GAT, The Generic Altimetry Tools</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-16 14:41:28" itemprop="dateCreated datePublished" datetime="2020-08-16T14:41:28+08:00">2020-08-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-10 23:18:25" itemprop="dateModified" datetime="2024-06-10T23:18:25+08:00">2024-06-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%8D%AB%E6%98%9F%E6%B5%8B%E9%AB%98/" itemprop="url" rel="index">
                    <span itemprop="name">卫星测高</span>
                  </a>
                </span>
            </span>

          
            <span id="/2020/08/16/GAT/" class="post-meta-item leancloud_visitors" data-flag-title="GAT, The Generic Altimetry Tools" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/08/16/GAT/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/08/16/GAT/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="卫星测高通用工具GAT"><a href="#卫星测高通用工具GAT" class="headerlink" title="卫星测高通用工具GAT"></a>卫星测高通用工具GAT</h2><p>我开源了卫星雷达高度计（卫星测高）的一些基本程序，取名<a href="https://github.com/GenericAltimetryTools" target="_blank" rel="noopener">The Generic Altimetry Tools</a>，简称GAT。名字的选择特别向<a href="https://github.com/GenericMappingTools/gmt" target="_blank" rel="noopener">GMT</a>致敬，GMT帮助了全世界无数的地球科学研究科研人员。<br>GAP程序面向卫星测高的科研人员，学生等群体，主要目的是对卫星测高数据进行数据处理，因此采用数据处理能力较强的matlab语言和PYTHON语言编写，并调用GMT的基本程序，现在可以实现如下功能：</p>
<ul>
<li>Netcdf文件格式的读取</li>
<li>SSH，SLA的计算</li>
<li>卫星测高交叉点分析</li>
<li>卫星测高绝对定标</li>
<li>卫星测高的湿延迟评估</li>
<li>卫星测高河湖的水位计算</li>
<li>卫星测高波形读取和绘图</li>
</ul>
<p>计划加入的功能：</p>
<ul>
<li>卫星测高交叉点平差</li>
<li>卫星测高共线平差</li>
<li>卫星测高重力反演</li>
<li>卫星测高水深反演</li>
<li>卫星测高中尺度涡探测</li>
<li>卫星测高的海平面变化分析</li>
<li>卫星测高波形重定</li>
<li>卫星测高极地海冰厚度计算</li>
<li>卫星测高海冰识别</li>
<li>卫星测高极地波形分类</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2020/08/16/linux-tools/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="学习笔记">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/16/linux-tools/" class="post-title-link" itemprop="url">命令工具常用操作</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-16 10:29:04" itemprop="dateCreated datePublished" datetime="2020-08-16T10:29:04+08:00">2020-08-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-08-13 10:55:04" itemprop="dateModified" datetime="2024-08-13T10:55:04+08:00">2024-08-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>
            </span>

          
            <span id="/2020/08/16/linux-tools/" class="post-meta-item leancloud_visitors" data-flag-title="命令工具常用操作" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/08/16/linux-tools/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/08/16/linux-tools/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这里列举一些常用的，又不容易记忆的linux工具命令，以及window快捷键</p>
<h3 id="当前目录打开cmd"><a href="#当前目录打开cmd" class="headerlink" title="当前目录打开cmd"></a>当前目录打开cmd</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">在地址栏中直接输入 <span class="keyword">cmd</span></span><br><span class="line"></span><br><span class="line"><span class="bash">    在文件资源管理器中导航到你希望打开 CMD 的目录。</span></span><br><span class="line">    在窗口的地址栏中，输入 <span class="keyword">cmd</span><span class="bash"> 然后按 Enter。</span></span><br><span class="line">    命令提示符将会在该目录中打开。</span><br></pre></td></tr></table></figure>



<h3 id="zotero-添加SCIhub"><a href="#zotero-添加SCIhub" class="headerlink" title="zotero 添加SCIhub"></a>zotero 添加SCIhub</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">Edit-Preference-Config</span> <span class="selector-tag">editor-extensions</span><span class="selector-class">.zotero</span><span class="selector-class">.findPDFs</span><span class="selector-class">.resolvers</span></span><br></pre></td></tr></table></figure>
<p>添加</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"name"</span>:<span class="string">"Sci-Hub"</span>,</span><br><span class="line">    <span class="attr">"method"</span>:<span class="string">"GET"</span>,</span><br><span class="line">    <span class="attr">"url"</span>:<span class="string">"https://sci-hub.ren/&#123;doi&#125;"</span>,</span><br><span class="line">    <span class="attr">"mode"</span>:<span class="string">"html"</span>,</span><br><span class="line">    <span class="attr">"selector"</span>:<span class="string">"#pdf"</span>,</span><br><span class="line">    <span class="attr">"attribute"</span>:<span class="string">"src"</span>,</span><br><span class="line">    <span class="attr">"automatic"</span>:<span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后，使用<code>Zotero Connector</code>或者<code>Find Available PDF</code>均可下载已有的PDF文件。</p>
<h3 id="nvidia"><a href="#nvidia" class="headerlink" title="nvidia"></a>nvidia</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi # 查看显卡信息</span><br><span class="line">watch -n <span class="number">0.1</span> nvidia-smi #每隔<span class="number">0.1</span>s更新</span><br><span class="line">lspci|grep NVIDIA # 查看显卡驱动</span><br><span class="line">lspci | grep -i vga</span><br><span class="line">sudo sh NVIDIA-Linux-x86_64<span class="number">-440.64</span>.run # 安装Nvidia驱动</span><br><span class="line"># 或者下面代码安装cuda</span><br><span class="line">sudo chmod +x cuda_11<span class="number">.0</span><span class="number">.3</span>_450<span class="number">.51</span><span class="number">.06</span>_linux.run</span><br><span class="line">sudo ./cuda_11<span class="number">.0</span><span class="number">.3</span>_450<span class="number">.51</span><span class="number">.06</span>_linux.run</span><br></pre></td></tr></table></figure>
<p>添加路径</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit ~/.bashrc</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="string">"/usr/local/cuda-11.0/bin:<span class="variable">$PATH</span>"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">LD_LIBRARY_PATH</span>=<span class="string">"/usr/local/cuda-11.0/lib64:<span class="variable">$LD_LIBRARY_PATH</span>"</span></span><br><span class="line">source ~/.bashrc</span><br><span class="line">nvcc -V # 查看cuda安装</span><br></pre></td></tr></table></figure>

<p>删除cuda。（有时候需要删除后，重新安装别的版本）</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">/usr/local/cuda-11.0/bin/</span></span><br><span class="line">sudo <span class="string">./cuda-uninstaller</span></span><br><span class="line">sudo rm -rf <span class="string">/usr/local/cuda-11.0</span></span><br></pre></td></tr></table></figure>

<p>安装cupti</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libcupti-dev</span><br><span class="line">export LD_LIBRARY_PATH=<span class="variable">$LD_LIBRARY_PATH</span><span class="symbol">:/usr/local/cuda/extras/CUPTI/lib64</span></span><br></pre></td></tr></table></figure>

<h3 id="Sphinx"><a href="#Sphinx" class="headerlink" title="Sphinx"></a>Sphinx</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">conda <span class="keyword">install</span> Sphinx</span><br><span class="line">sphinx-<span class="keyword">build</span> <span class="comment">--version</span></span><br><span class="line">sphinx-quickstart docs</span><br><span class="line">sphinx-<span class="keyword">build</span> -b html docs docs/_build/html</span><br></pre></td></tr></table></figure>

<h3 id="Colab"><a href="#Colab" class="headerlink" title="Colab"></a>Colab</h3><p>Colaboratory is built on top of Jupyter Notebook.</p>
<p>GPU可以快速提高训练的速度。Colab提供K80显卡，价格一万多元。</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 查看显存情况</span></span><br><span class="line">!/opt/bin/nvidia-smi</span><br><span class="line"></span><br><span class="line"><span class="meta"># 查看GPU</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="title">tf</span>.test.gpu_device_name()</span><br><span class="line"><span class="meta"># 在使用哪个GPU</span></span><br><span class="line"><span class="title">from</span> tensorflow.python.client <span class="keyword">import</span> device_lib</span><br><span class="line"><span class="title">device_lib</span>.list_local_devices()</span><br><span class="line"></span><br><span class="line"><span class="meta"># 查看CPU</span></span><br><span class="line">!cat  /<span class="keyword">proc</span>/cpuinfo</span><br><span class="line"></span><br><span class="line"><span class="meta"># RAM大小</span></span><br><span class="line">!cat /<span class="keyword">proc</span>/meminfo</span><br></pre></td></tr></table></figure>

<p>使用google drive数据的方法：<a href="https://colab.research.google.com/notebooks/io.ipynb" target="_blank" rel="noopener">https://colab.research.google.com/notebooks/io.ipynb</a></p>
<figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> google.colab <span class="keyword">import</span> drive</span><br><span class="line">drive.mount(<span class="string">'/content/drive'</span>)</span><br><span class="line"><span class="keyword">import</span> <span class="built_in">os</span></span><br><span class="line"><span class="built_in">os</span>.chdir(<span class="string">'/content/drive/My Drive/'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Conda"><a href="#Conda" class="headerlink" title="Conda"></a>Conda</h3><p>Conda 比较慢，可以使用mamba加速：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda <span class="keyword">install</span> -c conda-forge mamba</span><br></pre></td></tr></table></figure>
<p>之后，使用mamba替代conda使用。</p>
<p>Conda是一种python包管理工具，可以对环境进行封闭管理，不同环境之间不相互干扰。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">conda <span class="comment">--version # 版本号</span></span><br><span class="line">conda env list <span class="comment"># 列出所有环境</span></span><br><span class="line">conda list -n python_3.9 <span class="comment"># 列出非当前环境的包</span></span><br><span class="line">conda list <span class="comment"># 列出当前环境的包</span></span><br><span class="line">conda <span class="keyword">create</span> -n env_name package_name <span class="comment"># 创建环境，如conda create -n python2 python=2.7 </span></span><br><span class="line">conda <span class="keyword">activate</span> python2<span class="number">.7</span> <span class="comment"># 激活某环境</span></span><br><span class="line">conda deactivate <span class="comment"># 退出当前环境</span></span><br><span class="line">conda <span class="keyword">install</span> package_name <span class="comment">#在当前环境中安装包</span></span><br><span class="line">conda remove <span class="keyword">package</span> <span class="comment">#删除当前环境中的包</span></span><br><span class="line">conda <span class="keyword">install</span> <span class="comment">--name env_name package_name #在指定环境中安装包</span></span><br><span class="line">conda remove <span class="comment">-- name env_name package </span></span><br><span class="line">conda <span class="keyword">create</span> -n tensorflow_env tensorflow <span class="comment">#安装tensorflow的CPU版本</span></span><br><span class="line">conda <span class="keyword">install</span> tensorflow <span class="comment"># 在当前环境下安装tensorflow</span></span><br><span class="line">conda <span class="keyword">search</span> tensorflow <span class="comment"># 查找版本</span></span><br></pre></td></tr></table></figure>

<p>删除环境之前需要先<code>deactivate</code></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda deactivate tensorflow_env</span><br><span class="line">conda <span class="built_in">remove</span> -n tensorflow_env <span class="comment">--all</span></span><br></pre></td></tr></table></figure>

<p>添加conda-forge channel并设置为最高优先级</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda<span class="built_in"> config </span>--<span class="builtin-name">add</span> channels conda-forge</span><br></pre></td></tr></table></figure>

<p>查看现在的channel状态和优先级</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda<span class="built_in"> config </span>--<span class="builtin-name">get</span> channels</span><br></pre></td></tr></table></figure>

<p>激活某个环境，在环境中设置channel的严格优先。注，如果该环境中已经安装了若干库，则需要先更新所有的库以保证大多数库从conda-forge下载，以保持库的一致性。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># activate my environment</span></span><br><span class="line">conda activate my_env</span><br><span class="line"><span class="comment"># update all packages if needed</span></span><br><span class="line">conda update --all</span><br><span class="line"><span class="comment"># set channel priority as strict</span></span><br><span class="line">conda<span class="built_in"> config </span>--<span class="builtin-name">set</span> channel_priority strict</span><br></pre></td></tr></table></figure>


<p>使用添加频道 conda config –add 频道 —（你的频道） 您添加的最后一个频道获得最高优先级……所以请保持顺序。您可以添加频道，即使您已经拥有它们，以便更改优先级顺序.</p>
<p>恢复原来的源,删除添加的源和设置。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda<span class="built_in"> config </span>--remove-key channels</span><br></pre></td></tr></table></figure>

<h3 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h3><p>理解image、container。image可以共用，比如Ubuntu环境，而且非常精简。container是每次启动后的封闭容器，一个Ubuntu可以启动无数个container，彼此不相干。</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">docker</span> <span class="string">images</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">info</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">run -it ubuntu bash</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">ps</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">ps -aq</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">start (id)</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">restart</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">kill</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">kill $(docker ps -aq)</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">start -d (id)</span></span><br></pre></td></tr></table></figure>
<p>退出容器：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></table></figure>
<p>退出，但是还在后台运行，<code>Ctrl+P+Q</code>.<br>退出后再次进入<code>docker start -d (id)</code>或者<code>docker exec -it 3e17550b10c8 bash</code>。此外还有<code>attach</code>可以进入正在运行的窗口。</p>
<p>查看日志</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f -t <span class="comment">--details 3e17550b10c8</span></span><br></pre></td></tr></table></figure>

<h3 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h3><p>下面是简单的上传博客文章的hexo命令，其中<code>hexo d -m &quot;message&quot;</code> 可以产生<code>commit</code>。</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo <span class="keyword">new</span> <span class="type">post</span> <span class="string">"linux tools"</span></span><br><span class="line">hexo g</span><br><span class="line">hexo d -m <span class="string">"linux tools"</span></span><br></pre></td></tr></table></figure>

<p>插入公式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">uninstall</span> hexo-math <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-renderer-mathjax <span class="comment">--save</span></span><br></pre></td></tr></table></figure>

<p>配置参考：</p>
<blockquote>
<p><a href="https://www.jianshu.com/p/9b9c241146bc" target="_blank" rel="noopener">https://www.jianshu.com/p/9b9c241146bc</a></p>
</blockquote>
<blockquote>
<p>行内的公式用<code>$</code>公式内容<code>$</code>包裹起来，在公式中右键即可查看公式$\TeX$代码。<br>同样右键可查看公式代码。</p>
</blockquote>
<p>例如：<br>\begin{equation} \sum_{k=1}^{n} \frac{1}{1+8 \sin ^{2} \frac{k \pi}{n}}=\frac{n\left(2^{n}+1\right)}{3\left(2^{n}-1\right)} \end{equation}</p>
<p>文章抬头需要加入类似：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">hexo中插入数学公式</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2019</span><span class="number">-05</span><span class="number">-09</span> <span class="number">12</span><span class="string">:40:16</span></span><br><span class="line"><span class="attr">mathjax:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">tags:</span> </span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure>

<h3 id="git"><a href="#git" class="headerlink" title="git"></a>git</h3><p>常用git命令</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">status</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">"add dac"</span></span><br><span class="line">git <span class="built_in">push</span> <span class="built_in">origin</span> master</span><br></pre></td></tr></table></figure>

<p>弹出openSSH的问题，要求第二次输入username和密码，注意这里需要登录GitHub，新建一个Personal access tokens。username就是note的名字，密码就是token。</p>
<p>更新代码到本地。如果本地没有修改，可以直接使用：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">git pull</span></span><br></pre></td></tr></table></figure>

<p>撤销不小心add的文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset data<span class="regexp">/era5/</span><span class="number">4</span>d<span class="regexp">/south/</span>era5.pl.*.nc</span><br></pre></td></tr></table></figure>

<p><code>.gitignore</code>修改无效的问题<br><code>.gitignore</code>只能忽略那些原来没有被track的文件，如果某些文件已经被纳入了版本管理中，则修改.gitignore是无效的，所以我们需要使用rm命令清除一下相关的缓存内容.这样文件将以未追踪的形式出现，对某个文件取消跟踪。</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git rm -r <span class="comment">--cached .</span></span><br><span class="line">git <span class="keyword">add</span> .</span><br><span class="line">git <span class="keyword">commit</span> -m <span class="string">'update .gitignore'</span></span><br></pre></td></tr></table></figure>

<p>git撤回commit</p>
<blockquote>
<p>写完代码后，我们一般这样<br>git add . //添加所有文件<br>git commit -m “本功能全部完成”<br>执行完commit后，想撤回commit，怎么办？<br>这样凉拌：<br>git reset –soft HEAD^</p>
</blockquote>
<p>不再追踪某文件</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">rm</span> --cached <span class="keyword">test</span>/ja3_check/mypoints.kml</span><br></pre></td></tr></table></figure>

<p>在VPN，比如clash，环境下使用，遇到错误：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fatal: unable <span class="keyword">to</span> access <span class="string">'https://github.com/yangleir/gnsswave.git/'</span>: failed <span class="keyword">to</span> connect <span class="keyword">to</span> github.com<span class="built_in"> port </span>443: timed out</span><br></pre></td></tr></table></figure>
<p>解决方案：</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">config</span> --<span class="keyword">global</span> https<span class="variable">.proxy</span> http:<span class="comment">//127.0.0.1:7890</span></span><br><span class="line">git <span class="keyword">config</span> --<span class="keyword">global</span> https<span class="variable">.proxy</span> https:<span class="comment">//127.0.0.1:7890</span></span><br></pre></td></tr></table></figure>
<p>或者在用户根目录下，直接打开<code>.gitconfig</code>，手动修改：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[http]</span><br><span class="line">	postBuffer = 524288000</span><br><span class="line"><span class="built_in">	proxy </span>= 127.0.0.1:7890</span><br><span class="line">[https]</span><br><span class="line"><span class="built_in">	proxy </span>= 127.0.0.1:7890</span><br></pre></td></tr></table></figure>



<h3 id="批量解压gz"><a href="#批量解压gz" class="headerlink" title="批量解压gz"></a>批量解压gz</h3><p>我下载了很多个文件夹，每个文件夹下都是<code>gz</code>压缩文件，现在想批量解压指定文件夹的文件。</p>
<p>文件下载如下：</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ ls | head</span><br><span class="line">cycle_0066/</span><br><span class="line">cycle_0067/</span><br><span class="line">cycle_0068/</span><br><span class="line">cycle_0069/</span><br><span class="line">cycle_0070/</span><br><span class="line">cycle_0071/</span><br><span class="line">cycle_0072/</span><br><span class="line">cycle_0073/</span><br><span class="line">cycle_0074/</span><br><span class="line">cycle_0075/</span><br><span class="line"></span><br><span class="line">$ ls cycle_0099 | head</span><br><span class="line">global_sl<span class="built_in">a_l2p</span>_ntc_h2_C0099_P0001_20150704T020146_20150704T024914_20180712T075832.nc.gz</span><br><span class="line">global_sl<span class="built_in">a_l2p</span>_ntc_h2_C0099_P0002_20150704T025439_20150704T034613_20180712T075832.nc.gz</span><br><span class="line">global_sl<span class="built_in">a_l2p</span>_ntc_h2_C0099_P0003_20150704T034614_20150704T043339_20180712T075832.nc.gz</span><br><span class="line">global_sl<span class="built_in">a_l2p</span>_ntc_h2_C0099_P0004_20150704T043901_20150704T053040_20180712T075832.nc.gz</span><br><span class="line">global_sl<span class="built_in">a_l2p</span>_ntc_h2_C0099_P0005_20150704T053041_20150704T062248_20180712T075832.nc.gz</span><br><span class="line">global_sl<span class="built_in">a_l2p</span>_ntc_h2_C0099_P0006_20150704T062321_20150704T071508_20180712T075833.nc.gz</span><br><span class="line">global_sl<span class="built_in">a_l2p</span>_ntc_h2_C0099_P0007_20150704T071509_20150704T080720_20180712T075833.nc.gz</span><br><span class="line">global_sl<span class="built_in">a_l2p</span>_ntc_h2_C0099_P0008_20150704T080722_20150704T085935_20180712T075833.nc.gz</span><br><span class="line">global_sl<span class="built_in">a_l2p</span>_ntc_h2_C0099_P0009_20150704T085936_20150704T095149_20180712T075833.nc.gz</span><br><span class="line">global_sl<span class="built_in">a_l2p</span>_ntc_h2_C0099_P0010_20150704T095150_20150704T104402_20180712T075833.nc.gz</span><br></pre></td></tr></table></figure>
<p>解压cycle_0068和cycle_0069两个文件夹下的全部gz文件，并删除gz原始文件。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -d cycle_006[<span class="number">8</span><span class="number">-9</span>]<span class="comment">/*.gz</span></span><br></pre></td></tr></table></figure>

<h3 id="批量转换图片格式"><a href="#批量转换图片格式" class="headerlink" title="批量转换图片格式"></a>批量转换图片格式</h3><p>把pdf转为png，并设置density 300，表示图像每英寸面积内的像素点数，数值越高图片质量越高</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for <span class="meta">file</span> <span class="meta">in</span> <span class="comment">*.pdf;</span> <span class="meta">do</span> magick convert -density 300 $<span class="meta">file</span> $&#123;<span class="meta">file</span>%%.<span class="comment">*&#125;.png;</span> done</span><br></pre></td></tr></table></figure>
<h3 id="视频编辑"><a href="#视频编辑" class="headerlink" title="视频编辑"></a>视频编辑</h3><p>截取视频</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg  -i ./linchang.mp4 -vcodec copy -acodec copy -ss <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> -to <span class="number">00</span>:<span class="number">00</span>:<span class="number">16</span> ./cutout1.mp4 -y</span><br><span class="line">$ ffmpeg  -i ./linchang.mp4 -vcodec copy -acodec copy -ss <span class="number">00</span>:<span class="number">00</span>:<span class="number">29</span> -to <span class="number">00</span>:<span class="number">00</span>:<span class="number">48</span> ./cutout2.mp4 -y</span><br></pre></td></tr></table></figure>
<p>合并视频(对于MP4格式，需要先转ts再合并)</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -<span class="selector-tag">i</span> cutout1<span class="selector-class">.mp4</span> -c copy -bsf:v h264_mp4toannexb -f mpegts input1<span class="selector-class">.ts</span>   </span><br><span class="line">$ ffmpeg -<span class="selector-tag">i</span> cutout2<span class="selector-class">.mp4</span> -c copy -bsf:v h264_mp4toannexb -f mpegts input2<span class="selector-class">.ts</span>   </span><br><span class="line">$ ffmpeg -<span class="selector-tag">i</span> <span class="string">"concat:input1.ts|input2.ts"</span> -c copy -bsf:<span class="selector-tag">a</span> aac_adtstoasc -movflags +faststart output.mp4</span><br></pre></td></tr></table></figure>
<p>慢速，三倍慢速</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -i <span class="number">2021</span><span class="number">-02</span><span class="number">-19</span><span class="number">-22</span><span class="number">-38</span><span class="number">-32.</span>mp4 -vf  <span class="string">"setpts=3*PTS"</span> test2.mp4</span><br></pre></td></tr></table></figure>
<h3 id="Latex转word"><a href="#Latex转word" class="headerlink" title="Latex转word"></a>Latex转word</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">pandoc</span> <span class="selector-tag">template</span><span class="selector-class">.tex</span> <span class="selector-tag">-o</span> <span class="selector-tag">output</span><span class="selector-class">.docx</span> <span class="selector-tag">-w</span> <span class="selector-tag">docx</span>  <span class="selector-tag">--pdf-engine</span> <span class="selector-tag">pdflatex</span></span><br></pre></td></tr></table></figure>

<h3 id="Linux-解压乱码问题"><a href="#Linux-解压乱码问题" class="headerlink" title="Linux 解压乱码问题"></a>Linux 解压乱码问题</h3><p>使用下面的编码即可。</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip -O CP936 <span class="keyword">test</span>.<span class="keyword">zip</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2020/06/23/wavenumber-grdfft-spectrum1d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="学习笔记">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/23/wavenumber-grdfft-spectrum1d/" class="post-title-link" itemprop="url">wavenumber的模拟计算(二)</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-23 17:57:28" itemprop="dateCreated datePublished" datetime="2020-06-23T17:57:28+08:00">2020-06-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-10 23:18:25" itemprop="dateModified" datetime="2024-06-10T23:18:25+08:00">2024-06-10</time>
              </span>

          
            <span id="/2020/06/23/wavenumber-grdfft-spectrum1d/" class="post-meta-item leancloud_visitors" data-flag-title="wavenumber的模拟计算(二)" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/06/23/wavenumber-grdfft-spectrum1d/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/06/23/wavenumber-grdfft-spectrum1d/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>上一篇使用了MATLAB模拟二维波动网格，使用GMT做谱分析和绘图。本文进一步简化模拟代码，仅使用GMT一种语言可完成波数谱的模拟，并展示一维和二维波数谱的差异。</p>
<h2 id="GMT有几种计算波数谱的程序"><a href="#GMT有几种计算波数谱的程序" class="headerlink" title="GMT有几种计算波数谱的程序"></a>GMT有几种计算波数谱的程序</h2><p>GMT有spectrum1D和grdfft可以计算波数谱。</p>
<ul>
<li>spectrum1D:一维谱分析。</li>
<li>grdfft:二维谱分析，含x,y和径向三个方向的计算。</li>
</ul>
<h2 id="模拟代码"><a href="#模拟代码" class="headerlink" title="模拟代码"></a>模拟代码</h2><p>下面利用完全GMT工具进行波数谱的模拟，首先利用grdmath模拟出一个规范的正弦波二维矩阵，形成网格文件。然后使用grdfft计算三个方向的谱，使用spectrum1D计算X方向的一维波数谱。</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env bash</span><br><span class="line">ps=testgrd.ps</span><br><span class="line"></span><br><span class="line"># gmt grdmath -R<span class="number">-50</span>/<span class="number">50</span>/<span class="number">-50</span>/<span class="number">50</span> -I0<span class="number">.2</span> X Y ADD SIN = x.nc</span><br><span class="line">gmt grdmath -R<span class="number">-50</span>/<span class="number">50</span>/<span class="number">-50</span>/<span class="number">50</span> -I0<span class="number">.2</span> X SIN = x.nc</span><br><span class="line"></span><br><span class="line">gmt makecpt -Crainbow -T<span class="number">-1</span>/<span class="number">1</span>/<span class="number">0.1</span> &gt; t.cpt</span><br><span class="line">gmt grdimage x.nc -R<span class="number">-30</span>/<span class="number">30</span>/<span class="number">-30</span>/<span class="number">30</span> -JX3i -Ct.cpt -Bxa -Bya -BWSne -P -K -Y7i &gt; $ps</span><br><span class="line"></span><br><span class="line">gmt grd2xyz x.nc | awk '&#123;if ($<span class="number">2</span> == <span class="number">0</span>) print $<span class="number">0</span>&#125;' &gt; x.txt</span><br><span class="line">gmt psxy -R -J -O -K x.txt -Sc0<span class="number">.03</span>i -Gblack &gt;&gt; $ps</span><br><span class="line"># Do grdfft</span><br><span class="line">gmt grdfft x.nc -Er+w+n -Gfft.txt</span><br><span class="line">gmt grdfft x.nc -Ex+w+n -Gfftx.txt</span><br><span class="line">gmt grdfft x.nc -Ey+w+n -Gffty.txt</span><br><span class="line">gmt math fftx.txt -C1 SQR ffty.txt SQR ADD SQRT = fftrr.txt</span><br><span class="line"></span><br><span class="line"># Plot specrum result from grdfft</span><br><span class="line">gmt psbasemap -R1/<span class="number">20</span>/<span class="number">1e-14</span>/<span class="number">1e-2</span> -JX<span class="number">-2.8</span>il/<span class="number">3</span>il -Bxa1pf2g3+l<span class="string">"Wavelength"</span> -Bya1pg+l<span class="string">"power spectrum"</span> -BwNsE -K -X3<span class="number">.2</span>i -O &gt;&gt; $ps</span><br><span class="line">gmt psxy -R fft.txt  -J -W0<span class="number">.5</span>p,red, -O -K &gt;&gt; $ps</span><br><span class="line">gmt psxy -R fftx.txt  -J -W0<span class="number">.5</span>p,blue, -O -K &gt;&gt; $ps</span><br><span class="line">gmt psxy -R ffty.txt  -J -W0<span class="number">.5</span>p,green, -O -K &gt;&gt; $ps</span><br><span class="line">gmt psxy -R fftrr.txt  -J -W0<span class="number">.5</span>p,black, -O -K &gt;&gt; $ps</span><br><span class="line"></span><br><span class="line">gmt psbasemap -R0<span class="number">.05</span>/<span class="number">1e0</span>/<span class="number">1e-14</span>/<span class="number">1e-2</span> -JX2<span class="number">.8</span>il/<span class="number">3</span>il -BSE -Bxa1p+l<span class="string">"wavenumber/cycle"</span> -O -K&gt;&gt; $ps</span><br><span class="line"></span><br><span class="line">gmt pslegend -D+w1<span class="number">.2</span>i+jBL+o0<span class="number">.1</span>i/<span class="number">0.1</span>i -R -J -O -K -F+p1p+glightgray --FONT_ANNOT_PRIMARY=<span class="number">10</span>p,<span class="number">1</span>,black &lt;&lt; <span class="literal">EOF</span> &gt;&gt; $ps</span><br><span class="line">S <span class="number">0.2</span>i - <span class="number">0.5</span>i - <span class="number">1</span>p,red, <span class="number">0.5</span>i r</span><br><span class="line">S <span class="number">0.2</span>i - <span class="number">0.5</span>i - <span class="number">1</span>p,blue <span class="number">0.5</span>i x</span><br><span class="line">S <span class="number">0.2</span>i - <span class="number">0.5</span>i - <span class="number">1</span>p,green, <span class="number">0.5</span>i y</span><br><span class="line"><span class="literal">EOF</span></span><br><span class="line"></span><br><span class="line"># Do spectrum1D</span><br><span class="line">gmt psxy -R<span class="number">-30</span>/<span class="number">30</span>/<span class="number">-1</span>/<span class="number">1</span> -JX3i/<span class="number">3</span>i x.txt -i0,<span class="number">2</span> -Bxaf -Byaf -BWSne -O -K -X<span class="number">-3.2</span>i -Y<span class="number">-4.5</span>i &gt;&gt; $ps</span><br><span class="line">gmt psxy -R -J x.txt -i0,<span class="number">2</span> -Sc0<span class="number">.03</span>i -Gred -O -K &gt;&gt; $ps</span><br><span class="line"></span><br><span class="line">awk '&#123;print $<span class="number">1</span>,$<span class="number">3</span>&#125;' x.txt | gmt spectrum1d  -S256 -W --GMT_FFT=brenner -N -i1 -D0<span class="number">.2</span>  &gt; fft_spec.txt</span><br><span class="line">gmt psbasemap -R1/<span class="number">20</span>/<span class="number">1e-12</span>/<span class="number">1e2</span> -JX<span class="number">-2.8</span>il/<span class="number">3</span>il -Bxa1pf2g3+l<span class="string">"Wavelength"</span> -Bya1pg+l<span class="string">"power spectrum"</span> -BwNsE -K -X3<span class="number">.2</span>i -O &gt;&gt; $ps</span><br><span class="line">gmt psxy -R fft_spec.txt -J -W0<span class="number">.5</span>p,red, -O -K &gt;&gt; $ps</span><br><span class="line">gmt psbasemap -R0<span class="number">.05</span>/<span class="number">1e0</span>/<span class="number">1e-12</span>/<span class="number">1e2</span> -JX2<span class="number">.8</span>il/<span class="number">3</span>il -BSE -Bxa1p+l<span class="string">"wavenumber/cycle"</span> -O &gt;&gt; $ps</span><br><span class="line"></span><br><span class="line">awk '&#123;print $<span class="number">3</span>&#125;' x.txt| gmt gmtmath STDIN -Sl STD  SQR =</span><br><span class="line"></span><br><span class="line">gmt psconvert  $ps -P -Tg -A</span><br></pre></td></tr></table></figure>

<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><h3 id="z-sin-x"><a href="#z-sin-x" class="headerlink" title="z=sin(x)"></a>z=sin(x)</h3><p><img src="/images/testgrd.png" alt></p>
<p>上为二维FFT在三个方向的谱分析结果，黑色曲线为sqrt(x^2+y^2),径向的能量谱不与一维的平方和（开根号）相等。下为一维（彩图中横线的采样）谱分析结果（形状与二维FFT的X方向一致，但能量大小不一样）。</p>
<h3 id="z-sin-x-y"><a href="#z-sin-x-y" class="headerlink" title="z=sin(x+y)"></a>z=sin(x+y)</h3><p><img src="/images/testgrd2.png" alt></p>
<p>上图把函数改变，数据x和y方向周期依然是2pi,但是r方向是2pi*cos(pi/2)，即4.44。这样可以帮助理解r方向是什么方向。运行时，把下面的代码取消注释。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># gmt grdmath -R<span class="number">-50</span>/<span class="number">50</span>/<span class="number">-50</span>/<span class="number">50</span> -I0<span class="number">.2</span> X Y ADD SIN = x.nc</span><br></pre></td></tr></table></figure>

<h2 id="注意的问题"><a href="#注意的问题" class="headerlink" title="注意的问题"></a>注意的问题</h2><ul>
<li>spectrum1D得到的波数谱符合能量守恒定律，即输入信号的方差等于功率谱密度的积分，也就是谱和X轴围起来的面积。例如正弦波的方差为0.5，而功率密度的积分也恰好为0.5。</li>
<li>grdfft得到的波数谱不是密度谱，所以不遵循能量守恒。</li>
<li>grdfft的三个方向的谱的关系是什么？r^2=x^2+y^2？</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://yangleir.github.io/2020/02/15/wavenumber/" target="_blank" rel="noopener">wavenumber的模拟计算</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2020/06/13/math-fun/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="学习笔记">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/13/math-fun/" class="post-title-link" itemprop="url">math fun</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-13 17:54:25" itemprop="dateCreated datePublished" datetime="2020-06-13T17:54:25+08:00">2020-06-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-10 23:18:25" itemprop="dateModified" datetime="2024-06-10T23:18:25+08:00">2024-06-10</time>
              </span>

          
            <span id="/2020/06/13/math-fun/" class="post-meta-item leancloud_visitors" data-flag-title="math fun" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/06/13/math-fun/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/06/13/math-fun/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="阿基米德螺旋线"><a href="#阿基米德螺旋线" class="headerlink" title="阿基米德螺旋线"></a>阿基米德螺旋线</h3><p><img src="/images/luoxuanxian.jpg" alt></p>
<h3 id="心形线"><a href="#心形线" class="headerlink" title="心形线"></a>心形线</h3><p><img src="/images/heart.jpg" alt></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://jingyan.baidu.com/article/0bc808fc23808a1bd585b944.html" target="_blank" rel="noopener">参考</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2020/06/07/anni/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="学习笔记">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/07/anni/" class="post-title-link" itemprop="url">GMT 制作GIF动画</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-07 15:14:42" itemprop="dateCreated datePublished" datetime="2020-06-07T15:14:42+08:00">2020-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-10 23:18:25" itemprop="dateModified" datetime="2024-06-10T23:18:25+08:00">2024-06-10</time>
              </span>

          
            <span id="/2020/06/07/anni/" class="post-meta-item leancloud_visitors" data-flag-title="GMT 制作GIF动画" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/06/07/anni/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/06/07/anni/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="问：GMT自带的movie程序怎么制作动画？是否简单易用？"><a href="#问：GMT自带的movie程序怎么制作动画？是否简单易用？" class="headerlink" title="问：GMT自带的movie程序怎么制作动画？是否简单易用？"></a>问：GMT自带的movie程序怎么制作动画？是否简单易用？</h3><p>答：<a href="https://docs.generic-mapping-tools.org/dev/movie.html#s" target="_blank" rel="noopener">movie</a>是GMT的一个动画制作程序，设计的比较复杂，上手时间长，不易用。希望尝试的话，可以运行自带例子，你会发现它设计的使用方法和经典GMT是差别很大的，个人学习的使用经历比较糟糕。</p>
<h3 id="问：那怎么利用GMT做GIF动画？"><a href="#问：那怎么利用GMT做GIF动画？" class="headerlink" title="问：那怎么利用GMT做GIF动画？"></a>问：那怎么利用GMT做GIF动画？</h3><p>答：可以使用<a href="https://imagemagick.org" target="_blank" rel="noopener">ImageMagick</a>工具，只需要一行命令即可。</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">magick convert -<span class="keyword">delay</span> <span class="number">64</span> -<span class="keyword">loop</span> <span class="number">0</span> *.png  <span class="keyword">out</span>.gif</span><br></pre></td></tr></table></figure>
<p>首先使用GMT制作每帧png，然后用上面的命令把连续的png图像制作成GIF动画。（GMT movie的基本原理可能也是如此，但设计的复杂度太高）</p>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>这里以GNSS浮标观测的海面波动为例，希望展示波浪的时间变化规律。动画设置每一帧显示一个小时的波浪功率谱图像，不同帧使用不同的颜色表达。</p>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env bash</span></span><br><span class="line">gmt <span class="builtin-name">set</span> FORMAT_DATE_MAP <span class="string">"o dd"</span> FORMAT_CLOCK_MAP hh:mm </span><br><span class="line"><span class="attribute">gnss1</span>=./gnss_b1_hlf_allppk.txt</span><br><span class="line"><span class="attribute">R</span>=-R32400/119700/-0.565631/0.828242</span><br><span class="line"><span class="comment"># ==========================================================================================================</span></span><br><span class="line"><span class="keyword">for</span>((<span class="attribute">i</span>=1;i&lt;=23;i++));  </span><br><span class="line"><span class="keyword">do</span>   </span><br><span class="line">	echo <span class="variable">$i</span></span><br><span class="line">	((name = <span class="variable">$i</span> + 100))</span><br><span class="line">	<span class="attribute">ps</span>=a00$name.ps</span><br><span class="line">	<span class="attribute">r</span>=$(($RANDOM%255))</span><br><span class="line">	<span class="attribute">g</span>=$(($RANDOM%255))</span><br><span class="line">	<span class="attribute">b</span>=$(($RANDOM%255))</span><br><span class="line">	</span><br><span class="line">	((max =  <span class="variable">$i</span> * 3600))</span><br><span class="line">	((min = (<span class="variable">$i</span>-1) * 3600))</span><br><span class="line">	echo <span class="variable">$min</span></span><br><span class="line"></span><br><span class="line">	gmt psbasemap -R2019-03-31T09:00:00/2019-04-01T09:00:00/-0.565631/0.828242 -Bpxa4Hf1h -Bsxa1Df1D -Bpya0.4g0.2f0.2+l<span class="string">"WSSE(HPF)/m"</span> -JX10c/4c -BWSne -K &gt; <span class="variable">$ps</span></span><br><span class="line">	gmt psbasemap -R2/20/1e-4/1e0 -JX-10cl/10cl -Bxa2f3g3+l<span class="string">"period:second"</span> -Bya-1pg+l<span class="string">"power spectrum:m@+2@+/cycle/s"</span> -BWNse -K  -Y2.7i -O &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">	</span><br><span class="line">	awk <span class="string">'NR&lt;'</span><span class="string">"<span class="variable">$max</span>"</span><span class="string">' &amp;&amp; NR&gt;'</span><span class="string">"<span class="variable">$min</span>"</span><span class="string">'  &#123;print $1,$2&#125;'</span> <span class="variable">$gnss1</span> | gmt spectrum1d  -S256 -W <span class="attribute">--GMT_FFT</span>=brenner -N -i1 -D1 &gt; pow5.txt</span><br><span class="line">	awk <span class="string">' NR&lt;'</span><span class="string">"<span class="variable">$max</span>"</span><span class="string">'   &#123;print $1,$2&#125;'</span> <span class="variable">$gnss1</span>| gmt psxy  <span class="variable">$R</span>  -JX10c/4c -W0.5p,lightgray -P -K -O -Y-2.7i &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">	awk <span class="string">'NR&lt;'</span><span class="string">"<span class="variable">$max</span>"</span><span class="string">' &amp;&amp; NR&gt;'</span><span class="string">"<span class="variable">$min</span>"</span><span class="string">'  &#123;print $1,$2&#125;'</span> <span class="variable">$gnss1</span>| gmt psxy  <span class="variable">$R</span>  -JX10c/4c -W0.5p,<span class="variable">$r</span>/<span class="variable">$g</span>/<span class="variable">$b</span> -P -K -O  &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">	gmt psxy -R2/20/1e-4/1e0 -JX-10cl/10cl -K pow5.txt -W2.25p,<span class="variable">$r</span>/<span class="variable">$g</span>/<span class="variable">$b</span> -O -Y2.7i -i0,1 &gt;&gt; <span class="variable">$ps</span></span><br><span class="line"></span><br><span class="line">	gmt psbasemap -R0.05/0.5/1e-4/0.5 -JX10cl/10cl -Bxa2f3g3+l<span class="string">"Frequency:cycle/second"</span> -BS  -O &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">gmt psconvert <span class="variable">$ps</span> -A -Tg</span><br><span class="line">done</span><br><span class="line">magick convert -delay 64 -loop 0 *.png  out.gif</span><br></pre></td></tr></table></figure>

<h3 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h3><p><img src="/images/wave_spectrum.gif" alt></p>
<h3 id="在一张图上"><a href="#在一张图上" class="headerlink" title="在一张图上"></a>在一张图上</h3><p>如果是做PPT展示用，动画较好。如果是插入论文，则需要把不同时间的曲线叠加到一张图上。同样使用<code>for</code>循环，代码如下:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env bash</span></span><br><span class="line"><span class="comment"># Testing gmt spectrum1d power spectrum values</span></span><br><span class="line">gmt <span class="builtin-name">set</span> FORMAT_DATE_MAP <span class="string">"o dd"</span> FORMAT_CLOCK_MAP hh:mm </span><br><span class="line"><span class="attribute">ps</span>=test.ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># ==========================================================================================================</span></span><br><span class="line"><span class="comment"># Use GMT spectrum to calculate power spetrum of SSH</span></span><br><span class="line"><span class="attribute">gnss1</span>=./gnss_b1_hlf_allppk.txt</span><br><span class="line"><span class="attribute">gnss2</span>=./gnss_b2_hlf_allppk.txt</span><br><span class="line"></span><br><span class="line">gmt psbasemap -R2019-03-31T09:00:00/2019-04-01T09:00:00/-0.565631/0.828242 -Bpxa4Hf1h -Bsxa1Df1D -Bpya0.4g0.2f0.2+l<span class="string">"WSSE(HPF)/m"</span> -JX10c/4c -BWSne -K &gt; <span class="variable">$ps</span></span><br><span class="line">gmt psbasemap -R2/20/1e-4/1e0 -JX-10cl/10cl -Bxa2f3g3+l<span class="string">"period:second"</span> -Bya-1pg+l<span class="string">"power spectrum:m@+2@+/cycle/s"</span> -BWNse -K  -Y2.7i -O &gt;&gt; <span class="variable">$ps</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">R</span>=-R32400/119700/-0.565631/0.828242</span><br><span class="line">echo period &gt; period1_wind.txt</span><br><span class="line"><span class="comment"># echo period &gt; period_l.txt</span></span><br><span class="line"><span class="comment"># GNSS buoy1 set i&lt;=23;</span></span><br><span class="line"><span class="comment"># GNSS buoy2 set i&lt;=24;</span></span><br><span class="line"><span class="keyword">for</span>((<span class="attribute">i</span>=1;i&lt;=23;i++));  </span><br><span class="line"><span class="keyword">do</span>   </span><br><span class="line">	echo <span class="variable">$i</span></span><br><span class="line">	<span class="attribute">r</span>=$(($RANDOM%255))</span><br><span class="line">	<span class="attribute">g</span>=$(($RANDOM%255))</span><br><span class="line">	<span class="attribute">b</span>=$(($RANDOM%255))</span><br><span class="line">	# ((<span class="attribute">a</span>=1+2**3-4%3))</span><br><span class="line">	((max =  <span class="variable">$i</span> * 3600))</span><br><span class="line">	((min = (<span class="variable">$i</span>-1) * 3600))</span><br><span class="line">	echo <span class="variable">$min</span></span><br><span class="line">	# echo $(expr <span class="variable">$i</span> \* 3 + 1);  </span><br><span class="line">	# awk 中使用变量的小技巧“‘val’”</span><br><span class="line">	</span><br><span class="line">	awk <span class="string">'NR&lt;'</span><span class="string">"<span class="variable">$max</span>"</span><span class="string">' &amp;&amp; NR&gt;'</span><span class="string">"<span class="variable">$min</span>"</span><span class="string">'  &#123;print $1,$2&#125;'</span> <span class="variable">$gnss1</span> | gmt spectrum1d  -S256 -W <span class="attribute">--GMT_FFT</span>=brenner -N -i1 -D1 &gt; pow5.txt</span><br><span class="line">	awk <span class="string">'NR&lt;'</span><span class="string">"<span class="variable">$max</span>"</span><span class="string">' &amp;&amp; NR&gt;'</span><span class="string">"<span class="variable">$min</span>"</span><span class="string">'  &#123;print $1,$2&#125;'</span> <span class="variable">$gnss1</span>| gmt psxy  <span class="variable">$R</span>  -JX10c/4c -W0.5p,<span class="variable">$r</span>/<span class="variable">$g</span>/<span class="variable">$b</span> -P -K -O -Y-2.7i &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">	gmt psxy -R2/20/1e-4/1e0 -JX-10cl/10cl -K pow5.txt -W2.25p,<span class="variable">$r</span>/<span class="variable">$g</span>/<span class="variable">$b</span> -O -Y2.7i -i0,1 &gt;&gt; <span class="variable">$ps</span></span><br><span class="line"></span><br><span class="line">	gmt gmtselect -R2/7/1e-4/1e0 pow5.txt | sort -k 2 | tail -n 1| awk <span class="string">'&#123;print '</span><span class="string">"<span class="variable">$i</span>+8"</span><span class="string">',$1&#125;'</span> &gt;&gt; period1_wind.txt</span><br><span class="line">done</span><br><span class="line">gmt psbasemap -R0.05/0.5/1e-4/1e0 -JX10cl/10cl -Bxa2f3g3+l<span class="string">"Frequency:cycle/second"</span> -BS  -O -K&gt;&gt; <span class="variable">$ps</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###B2</span></span><br><span class="line">gmt psbasemap -R2019-03-31T09:00:00/2019-04-01T09:00:00/-0.565631/0.828242 -Bpxa4Hf1h -Bsxa1Df1D -Bpya0.4g0.2f0.2+l<span class="string">"WSSE(HPF)/m"</span> -JX10c/4c -BwSnE -K  -X11c -Y-2.7i -O &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">gmt psbasemap -R2/20/1e-4/1e0 -JX-10cl/10cl -Bxa2f3g3+l<span class="string">"period:second"</span> -Bya-1pg+l<span class="string">"power spectrum:m@+2@+/cycle/s"</span> -BwNsE -K  -Y2.7i -O &gt;&gt; <span class="variable">$ps</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">R</span>=-R32400/119700/-0.565631/0.828242</span><br><span class="line">echo period &gt; period2_wind.txt</span><br><span class="line"><span class="comment"># GNSS buoy1 set i&lt;=23;</span></span><br><span class="line"><span class="comment"># GNSS buoy2 set i&lt;=24;</span></span><br><span class="line"><span class="keyword">for</span>((<span class="attribute">i</span>=1;i&lt;=24;i++));  </span><br><span class="line"><span class="keyword">do</span>   </span><br><span class="line">	echo <span class="variable">$i</span></span><br><span class="line">	<span class="attribute">r</span>=$(($RANDOM%255))</span><br><span class="line">	<span class="attribute">g</span>=$(($RANDOM%255))</span><br><span class="line">	<span class="attribute">b</span>=$(($RANDOM%255))</span><br><span class="line">	# ((<span class="attribute">a</span>=1+2**3-4%3))</span><br><span class="line">	((max =  <span class="variable">$i</span> * 3600))</span><br><span class="line">	((min = (<span class="variable">$i</span>-1) * 3600))</span><br><span class="line">	echo <span class="variable">$min</span></span><br><span class="line">	# echo $(expr <span class="variable">$i</span> \* 3 + 1);  </span><br><span class="line">	# awk 中使用变量的小技巧“‘val’”</span><br><span class="line">	</span><br><span class="line">	awk <span class="string">'NR&lt;'</span><span class="string">"<span class="variable">$max</span>"</span><span class="string">' &amp;&amp; NR&gt;'</span><span class="string">"<span class="variable">$min</span>"</span><span class="string">'  &#123;print $1,$2&#125;'</span> <span class="variable">$gnss2</span> | gmt spectrum1d  -S256 -W <span class="attribute">--GMT_FFT</span>=brenner -N -i1 -D1 &gt; pow5.txt</span><br><span class="line">	awk <span class="string">'NR&lt;'</span><span class="string">"<span class="variable">$max</span>"</span><span class="string">' &amp;&amp; NR&gt;'</span><span class="string">"<span class="variable">$min</span>"</span><span class="string">'  &#123;print $1,$2&#125;'</span>  <span class="variable">$gnss2</span>| gmt psxy  <span class="variable">$R</span>  -JX10c/4c -W0.5p,<span class="variable">$r</span>/<span class="variable">$g</span>/<span class="variable">$b</span> -P -K -O -Y-2.7i &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">	gmt psxy -R2/20/1e-4/1e0 -JX-10cl/10cl -K pow5.txt -W2.25p,<span class="variable">$r</span>/<span class="variable">$g</span>/<span class="variable">$b</span> -O -Y2.7i -i0,1 &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">	gmt gmtselect -R2/7/1e-4/1e0 pow5.txt | sort -k 2 | tail -n 1| awk <span class="string">'&#123;print '</span><span class="string">"<span class="variable">$i</span>+8"</span><span class="string">',$1&#125;'</span> &gt;&gt; period2_wind.txt</span><br><span class="line">done</span><br><span class="line">gmt psbasemap -R0.05/0.5/1e-4/1e0 -JX10cl/10cl -Bxa2f3g3+l<span class="string">"Frequency:cycle/second"</span> -BS  -O &gt;&gt; <span class="variable">$ps</span></span><br><span class="line"></span><br><span class="line">gmt psconvert <span class="variable">$ps</span> -A -Tf</span><br><span class="line">rm gmt.* h_f.txt smooth_track* t.d</span><br></pre></td></tr></table></figure>

<p><img src="/images/one_figure_more_color.png" alt></p>
<h3 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h3><p><a href="https://www.jianguoyun.com/p/DXyywDoQ2PCQBxjrxaAD" target="_blank" rel="noopener">GNSS data 1</a><br><a href="https://www.jianguoyun.com/p/DedS1rAQ2PCQBxirpOMD" target="_blank" rel="noopener">GNSS data 2</a></p>
<h3 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h3><ul>
<li><a href="http://www.graphicsmagick.org" target="_blank" rel="noopener">GraphicsMagick</a>是从<a href="https://imagemagick.org/" target="_blank" rel="noopener">ImageMagick</a>中分离出来的，推荐下载ImageMagick。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2020/03/02/distance-to-coast/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="学习笔记">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/02/distance-to-coast/" class="post-title-link" itemprop="url">GMT 计算任意点到海岸线的最短距离</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-02 15:14:42" itemprop="dateCreated datePublished" datetime="2020-03-02T15:14:42+08:00">2020-03-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-10 23:18:25" itemprop="dateModified" datetime="2024-06-10T23:18:25+08:00">2024-06-10</time>
              </span>

          
            <span id="/2020/03/02/distance-to-coast/" class="post-meta-item leancloud_visitors" data-flag-title="GMT 计算任意点到海岸线的最短距离" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/03/02/distance-to-coast/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/03/02/distance-to-coast/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="问：我想计算海洋上的任意点到海岸线的（最短）距离，并制作一个网格文件存储这些距离，请问如何？"><a href="#问：我想计算海洋上的任意点到海岸线的（最短）距离，并制作一个网格文件存储这些距离，请问如何？" class="headerlink" title="问：我想计算海洋上的任意点到海岸线的（最短）距离，并制作一个网格文件存储这些距离，请问如何？"></a>问：我想计算海洋上的任意点到海岸线的（最短）距离，并制作一个网格文件存储这些距离，请问如何？</h3><p>答：使用grdmath可获得全球任意点到海岸线距离的网格。这里的距离就是垂直最短距离。</p>
<h3 id="问：我想绘制一条线，表示到海岸线的距离。"><a href="#问：我想绘制一条线，表示到海岸线的距离。" class="headerlink" title="问：我想绘制一条线，表示到海岸线的距离。"></a>问：我想绘制一条线，表示到海岸线的距离。</h3><p>答：通过设置grdcontour可以导出指定的等值线坐标到文本，比如我们要绘制距离海岸线50km的线，或者专属经济区的线等。</p>
<h3 id="问：我想根据到海岸线的距离提取点位，可以吗？"><a href="#问：我想根据到海岸线的距离提取点位，可以吗？" class="headerlink" title="问：我想根据到海岸线的距离提取点位，可以吗？"></a>问：我想根据到海岸线的距离提取点位，可以吗？</h3><p>答：可以。下面的例子中有这个功能的使用。如从我国GNSS陆态网站点中提取出距离海岸线50km的点，并绘制。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/03/02/distance-to-coast/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2020/02/15/wavenumber/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="学习笔记">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/15/wavenumber/" class="post-title-link" itemprop="url">wavenumber的模拟计算</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-02-15 22:01:51" itemprop="dateCreated datePublished" datetime="2020-02-15T22:01:51+08:00">2020-02-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-10 23:18:25" itemprop="dateModified" datetime="2024-06-10T23:18:25+08:00">2024-06-10</time>
              </span>

          
            <span id="/2020/02/15/wavenumber/" class="post-meta-item leancloud_visitors" data-flag-title="wavenumber的模拟计算" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/02/15/wavenumber/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/02/15/wavenumber/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在物理海洋学中有一个常用的量叫做wavenumber，翻译为波数，其频谱叫做波数谱。一般来说，遥感和测绘学科中对波数谱较为陌生，大家使用最多的时间相关的频率谱，而波数谱是空间谱。海洋学中定点观测（如浮标）获得的数据一般是时间序列，可以计算频率谱，而卫星（如高度计）得到的是沿轨数据，属于空间域，卫星数据可以用于计算波数谱。本文简单对此介绍，并使用GMT和MATLAB做简单的模拟，以求两种维度的谱概念清晰易懂。</p>
<h2 id="wavenumber是什么？和frequency是什么关系？"><a href="#wavenumber是什么？和frequency是什么关系？" class="headerlink" title="wavenumber是什么？和frequency是什么关系？"></a>wavenumber是什么？和frequency是什么关系？</h2><ul>
<li>wavenumber是空间域频率，相当于单位长度有多少个波，也就是波数，其物理单位可以是CPKM(cycle per km)。 所谓波数谱分析就是指空间域的FFT分析，可以是一维的along-track分析，也可以是二维的空间分析，波数谱分析的Y轴单位一般是cm^2/CPKM，表示在某一波数上的能量。</li>
<li>frequency是时间域的频率，相当于单位时间内的波的个数，大家都懂。</li>
<li>wavelength是波长，就是一个波的空间长度（空间域）或者时间长度（时间域），时空通用。<blockquote>
<p>In the physical sciences, the wavenumber (also wave number or repetency) is the spatial frequency of a wave, measured in cycles per unit distance or radians per unit distance. Whereas temporal frequency can be thought of as the number of waves per unit time, wavenumber is the number of waves per unit distance.</p>
</blockquote>
</li>
<li>维基百科<a href="https://en.wikipedia.org/wiki/Wavenumber" target="_blank" rel="noopener">wavenumber</a></li>
<li>参考图（来自维基百科）：<img src="/images/wave.png" alt></li>
<li>k表示波数，是物理海洋中的一个常见符号。例如，波长为0.5km，那么线性的波数为2，表示单位长度（1km）内有两个波。k也可以用弧度表示,等于2Pi/wavelenth，线性波数2再乘以2Pi为4Pi，是以[rad/m]为单位的波数表达形式。</li>
</ul>
<h2 id="wavenumber怎么计算，MATLAB、PYTHON，GMT？"><a href="#wavenumber怎么计算，MATLAB、PYTHON，GMT？" class="headerlink" title="wavenumber怎么计算，MATLAB、PYTHON，GMT？"></a>wavenumber怎么计算，MATLAB、PYTHON，GMT？</h2><p>几乎所有的语言都可以计算波数（傅里叶分析），下列是几套较为成熟的开源软件：</p>
<ul>
<li>PYTHON: <a href="https://github.com/pyspec" target="_blank" rel="noopener">pyspec</a>，论文中开源的代码和数据，含有详细的结果分析。</li>
<li>Matlab: <a href="https://github.com/jonathanlilly/jLab" target="_blank" rel="noopener">jlab</a>，一套丰富的海洋大数据分析工具。</li>
<li>GMT: GMT内置了两种计算PSD的程序，一维的spectrum1d和二维的grdfft。</li>
</ul>
<h2 id="MATALB-GMT的二维wavenumber模拟计算"><a href="#MATALB-GMT的二维wavenumber模拟计算" class="headerlink" title="MATALB+GMT的二维wavenumber模拟计算"></a>MATALB+GMT的二维wavenumber模拟计算</h2><h3 id="MATLAB模拟二维网格"><a href="#MATLAB模拟二维网格" class="headerlink" title="MATLAB模拟二维网格"></a>MATLAB模拟二维网格</h3><p>参数设置：</p>
<ul>
<li>网格维度为1600*801，间隔为0.3m。</li>
<li>波长为50m和10m的叠加。</li>
<li>加入了白噪声。</li>
</ul>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% test NetCDF write</span></span><br><span class="line"><span class="comment">% Author: Yang Lei,2020-04-19,Qingdao. Email:leiyang@fio.org.cn</span></span><br><span class="line">clear all;</span><br><span class="line">delete (<span class="string">'test_simulate.nc'</span>)</span><br><span class="line">lati = <span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">1600</span>*<span class="number">0.3</span>,<span class="number">1600</span>);</span><br><span class="line">long = <span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">1600</span>*<span class="number">0.3</span>,<span class="number">1600</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">% simulate wave </span></span><br><span class="line"><span class="comment">% build 1D sinewave</span></span><br><span class="line">SineMid = <span class="built_in">sin</span>(<span class="number">2</span>*<span class="built_in">pi</span>/<span class="number">10</span>*long);</span><br><span class="line"></span><br><span class="line"><span class="comment">% translate 1D wave into 2D sinewave</span></span><br><span class="line">SinewaveM = <span class="built_in">repmat</span>(SineMid,[<span class="number">1600</span>,<span class="number">1</span>]);</span><br><span class="line">imagesc(SinewaveM)</span><br><span class="line">Angle = <span class="number">10</span>;</span><br><span class="line">Irot = imrotate(SinewaveM, Angle, <span class="string">'loose'</span>, <span class="string">'bilinear'</span>);</span><br><span class="line"><span class="comment">% imagesc(Irot)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% figure out the image size of new Sinewave.</span></span><br><span class="line">Start = <span class="built_in">floor</span>(<span class="built_in">size</span>(Irot,<span class="number">1</span>)/<span class="number">4</span>);</span><br><span class="line">Stop = <span class="number">3</span>*Start;</span><br><span class="line"> </span><br><span class="line"><span class="comment">% image crop</span></span><br><span class="line">Icrop = Irot(Start:Stop,Start:Stop);</span><br><span class="line">L_x=<span class="built_in">length</span>(Icrop);</span><br><span class="line"></span><br><span class="line">temp=Icrop;</span><br><span class="line"></span><br><span class="line">ssh_wave = temp+<span class="number">0.1</span>*<span class="built_in">rand</span>(L_x,L_x);</span><br><span class="line">imagesc(ssh_wave)</span><br><span class="line"></span><br><span class="line"><span class="comment">% netcdf.create</span></span><br><span class="line">nccreate(<span class="string">'test_simulate.nc'</span>,<span class="string">'lat'</span>,<span class="string">'Dimensions'</span>,&#123;<span class="string">'lat'</span> L_x&#125;);</span><br><span class="line"></span><br><span class="line">ncwriteatt(<span class="string">'test_simulate.nc'</span>, <span class="string">'lat'</span>, <span class="string">'standard_name'</span>, <span class="string">'lat'</span>);</span><br><span class="line">ncwriteatt(<span class="string">'test_simulate.nc'</span>, <span class="string">'lat'</span>, <span class="string">'long_name'</span>, <span class="string">'lat'</span>);</span><br><span class="line">ncwriteatt(<span class="string">'test_simulate.nc'</span>, <span class="string">'lat'</span>, <span class="string">'units'</span>, <span class="string">'meter'</span>);</span><br><span class="line">ncwriteatt(<span class="string">'test_simulate.nc'</span>, <span class="string">'lat'</span>, <span class="string">'_CoordinateAxisType'</span>, <span class="string">'Lat'</span>);</span><br><span class="line"><span class="comment">% ncwriteatt('test_files.nc','/','standard_name','latitude');</span></span><br><span class="line">nccreate(<span class="string">'test_simulate.nc'</span>,<span class="string">'lon'</span>,<span class="string">'Dimensions'</span>,&#123;<span class="string">'lon'</span> L_x&#125;);</span><br><span class="line">ncwriteatt(<span class="string">'test_simulate.nc'</span>, <span class="string">'lon'</span>, <span class="string">'standard_name'</span>, <span class="string">'lon'</span>);</span><br><span class="line">ncwriteatt(<span class="string">'test_simulate.nc'</span>, <span class="string">'lon'</span>, <span class="string">'long_name'</span>, <span class="string">'lon'</span>);</span><br><span class="line">ncwriteatt(<span class="string">'test_simulate.nc'</span>, <span class="string">'lon'</span>, <span class="string">'units'</span>, <span class="string">'meter'</span>);</span><br><span class="line">ncwriteatt(<span class="string">'test_simulate.nc'</span>, <span class="string">'lon'</span>, <span class="string">'_CoordinateAxisType'</span>, <span class="string">'Lon'</span>);</span><br><span class="line"></span><br><span class="line">nccreate(<span class="string">'test_simulate.nc'</span>,<span class="string">'Q'</span>,<span class="string">'datatype'</span>,<span class="string">'double'</span>,<span class="string">'Dimensions'</span>,&#123;<span class="string">'lat'</span> L_x <span class="string">'lon'</span> L_x&#125;);</span><br><span class="line">ncwriteatt(<span class="string">'test_simulate.nc'</span>, <span class="string">'Q'</span>, <span class="string">'standard_name'</span>, <span class="string">'ssh'</span>);</span><br><span class="line">ncwriteatt(<span class="string">'test_simulate.nc'</span>, <span class="string">'Q'</span>, <span class="string">'long_name'</span>, <span class="string">'sea surface height'</span>);</span><br><span class="line">ncwriteatt(<span class="string">'test_simulate.nc'</span>, <span class="string">'Q'</span>, <span class="string">'units'</span>, <span class="string">'m'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">% ncdisp('test_files.nc');</span></span><br><span class="line">ncwrite(<span class="string">'test_simulate.nc'</span>,<span class="string">'lat'</span>,lati(<span class="number">1</span>:L_x));</span><br><span class="line">ncwrite(<span class="string">'test_simulate.nc'</span>,<span class="string">'lon'</span>,long(<span class="number">1</span>:L_x));</span><br><span class="line"></span><br><span class="line">ncwrite(<span class="string">'test_simulate.nc'</span>,<span class="string">'Q'</span>,ssh_wave);</span><br><span class="line"></span><br><span class="line">ncdisp(<span class="string">'test_simulate.nc'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="利用GMT的grdfft进行二维FFT分析，得到波数谱。"><a href="#利用GMT的grdfft进行二维FFT分析，得到波数谱。" class="headerlink" title="利用GMT的grdfft进行二维FFT分析，得到波数谱。"></a>利用GMT的grdfft进行二维FFT分析，得到波数谱。</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="attribute">gmt</span> gmtset MAP_GRID_PEN_PRIMARY	= <span class="number">0</span>.1p,<span class="number">0</span>/<span class="number">0</span>/<span class="number">0</span>,2_1_0.25_1:<span class="number">0</span></span><br><span class="line"></span><br><span class="line">ps=gf-fft.ps</span><br><span class="line"></span><br><span class="line">data_jizai=test_simulate.nc</span><br><span class="line"></span><br><span class="line">gmt grdfft <span class="variable">$data_jizai</span> -Ex+w+n -Gx.txt</span><br><span class="line">gmt grdfft <span class="variable">$data_jizai</span> -Ey+w+n -Gy.txt</span><br><span class="line">gmt grdfft <span class="variable">$data_jizai</span> -Er+w+n -Gr.txt</span><br><span class="line"></span><br><span class="line">awk <span class="string">'&#123;print <span class="variable">$1</span>,<span class="variable">$2</span>&#125;'</span> x.txt &gt; jizai.x </span><br><span class="line">awk <span class="string">'&#123;print <span class="variable">$1</span>,<span class="variable">$2</span>&#125;'</span> y.txt &gt; jizai.y</span><br><span class="line">awk <span class="string">'&#123;print <span class="variable">$1</span>,<span class="variable">$2</span>&#125;'</span> r.txt &gt; jizai.z</span><br><span class="line"></span><br><span class="line">x=`awk <span class="string">'&#123;print <span class="variable">$1</span>,<span class="variable">$2</span>&#125;'</span> x.txt | sort -k <span class="number">2</span> | head -n <span class="number">1</span> | awk <span class="string">'&#123;print <span class="variable">$1</span>&#125;'</span>`</span><br><span class="line">y=`awk <span class="string">'&#123;print <span class="variable">$1</span>,<span class="variable">$2</span>&#125;'</span> y.txt | sort -k <span class="number">2</span> | head -n <span class="number">1</span> | awk <span class="string">'&#123;print <span class="variable">$1</span>&#125;'</span>`</span><br><span class="line">r=`awk <span class="string">'&#123;print <span class="variable">$1</span>,<span class="variable">$2</span>&#125;'</span> r.txt | sort -k <span class="number">2</span> | head -n <span class="number">1</span> | awk <span class="string">'&#123;print <span class="variable">$1</span>&#125;'</span>`</span><br><span class="line"></span><br><span class="line">echo <span class="variable">$x</span> <span class="variable">$y</span> <span class="variable">$r</span></span><br><span class="line">gmt gmtmath -Q <span class="variable">$x</span> <span class="variable">$y</span> DIV ATAN <span class="number">180</span> pi DIV MUL <span class="number">90</span> SUB NEG =</span><br><span class="line"></span><br><span class="line">gmt psbasemap -R0.<span class="number">1</span>/1e3/1e-<span class="number">15</span>/1e5 -JX-4il/4il -Bxa1pf3g3+l<span class="string">"Wavelength/m"</span> -Bya1pf1+l<span class="string">"power spectrum"</span> -BWNe -K &gt; <span class="variable">$ps</span></span><br><span class="line"></span><br><span class="line">gmt psxy -R jizai.x  -J -W0.5p,black, -O -K &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">gmt psxy -R jizai.y -J -W0.5p,blue, -O -K &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">gmt psxy -R jizai.z -J -W0.5p,red, -O -K &gt;&gt; <span class="variable">$ps</span></span><br><span class="line"></span><br><span class="line">gmt psbasemap -R1e-<span class="number">3</span>/1e1/1e-<span class="number">15</span>/1e5 -JX4il/4il -BSE -Bxa1p+l<span class="string">"wavenumber/cycle/m"</span> -O -K&gt;&gt; <span class="variable">$ps</span></span><br><span class="line"></span><br><span class="line">gmt pslegend -D+w0.8i+jBL+o0i/.2i -R -J -O -F+p1p+glightgray --FONT_ANNOT_PRIMARY=7p &lt;&lt; EOF &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">S <span class="number">0</span>.2i - <span class="number">0</span>.5i - 1p,red <span class="number">0</span>.5i x</span><br><span class="line">S <span class="number">0</span>.2i - <span class="number">0</span>.5i - 1p,blue <span class="number">0</span>.5i y  </span><br><span class="line">S <span class="number">0</span>.2i - <span class="number">0</span>.5i - 1p,tan <span class="number">0</span>.5i r</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">gmt psconvert <span class="variable">$ps</span> -A -P -Tg</span><br><span class="line"></span><br><span class="line">rm <span class="regexp">gmt.*</span> <span class="regexp">jizai.*</span> <span class="regexp">*.cpt</span> <span class="regexp">*.d</span> <span class="regexp">*.nc</span></span><br></pre></td></tr></table></figure>

<p>结果计算得到三个方向的波长和径向传播角度：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">61.478424015</span> <span class="number">10.2464040025</span> <span class="number">10.2464040025</span></span><br><span class="line"><span class="number">9.46232220803</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/gf-fft.png" alt></p>
<h3 id="PLOT-grid"><a href="#PLOT-grid" class="headerlink" title="PLOT grid"></a>PLOT grid</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line">	</span><br><span class="line">data=test_files.nc</span><br><span class="line"></span><br><span class="line">ps=mss.ps</span><br><span class="line">J=JX4i</span><br><span class="line"></span><br><span class="line">gmt makecpt -Crainbow -T-13/13/0.01 -Z &gt;mss.cpt</span><br><span class="line">gmt psbasemap -R<span class="variable">$data</span> -<span class="variable">$J</span> -BWNSE -Bxya100 -K &gt; <span class="variable">$ps</span></span><br><span class="line">gmt grdimage <span class="variable">$data</span> -<span class="variable">$J</span> -Cmss.cpt -K -O &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">gmt psscale -DjCB+w1.5i+o0/-1.4c+h -Cmss -Bxaf -By+lm -R -J -O -V &gt;&gt; <span class="variable">$ps</span></span><br><span class="line">gmt psconvert mss.ps -A -P -Tg</span><br></pre></td></tr></table></figure>
<p><img src="/images/grid_fft.png" alt></p>
<h2 id="Attention"><a href="#Attention" class="headerlink" title="Attention"></a>Attention</h2><ul>
<li>如果matlab中的XY属性给的随意，写成了longitude，latitude，而实际上是笛卡尔坐标，则GMT在识别的时候仍旧认为是经纬度，因此不能大于360或者90。所以在写nc文件的时候要注意属性名称。</li>
<li>kx和ky的计算分别使用-Ex和-Ey.</li>
<li>默认的计算方向是the radial direction </li>
<li>波的传播方向可以通过kx和ky的波长计算，atan(ky/kx)。</li>
<li>波的径向传播方向只能通过径向的FFT计算，不可以简单的相加kx和ky。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://assz0a.coding-pages.com/2020/02/05/gmt-api-c/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/xingchi.jpg">
      <meta itemprop="name" content="学习笔记">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="学习笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2020/02/05/gmt-api-c/" class="post-title-link" itemprop="url">GMT API C 在windows的使用</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-02-05 11:04:12" itemprop="dateCreated datePublished" datetime="2020-02-05T11:04:12+08:00">2020-02-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-10 23:18:25" itemprop="dateModified" datetime="2024-06-10T23:18:25+08:00">2024-06-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GMT/" itemprop="url" rel="index">
                    <span itemprop="name">GMT</span>
                  </a>
                </span>
            </span>

          
            <span id="/2020/02/05/gmt-api-c/" class="post-meta-item leancloud_visitors" data-flag-title="GMT API C 在windows的使用" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/02/05/gmt-api-c/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/02/05/gmt-api-c/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>前期咨询了GMT开发者一些windows中使用GMT C API的问题，可以<a href="https://forum.generic-mapping-tools.org/t/how-to-use-gmt-api/219/6" target="_blank" rel="noopener">看这</a>，发现直接使用GMT exe安装包中的库总是出现问题(可能和依赖有关系？和平台有关系？)，最终选择了使用visual studio 2019进行源码编译lib，并调用API试验。</p>
<p>API C调用的一个<b><a href="https://docs.generic-mapping-tools.org/dev/api.html#example-code" target="_blank" rel="noopener">例子源码</a></b>：</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/02/05/gmt-api-c/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/17/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><span class="page-number current">18</span><a class="page-number" href="/page/19/">19</a><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/19/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="学习笔记"
      src="/images/xingchi.jpg">
  <p class="site-author-name" itemprop="name">学习笔记</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">191</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">95</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://getmyte.com/" title="https:&#x2F;&#x2F;getmyte.com&#x2F;" rel="noopener" target="_blank">getmyte</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.economist.com/" title="https:&#x2F;&#x2F;www.economist.com&#x2F;" rel="noopener" target="_blank">Economist</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://l7.antv.vision/en/" title="https:&#x2F;&#x2F;l7.antv.vision&#x2F;en&#x2F;" rel="noopener" target="_blank">AntV</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">学习笔记</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v7.3.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.7.0
  </div>

        






  <script>
  function leancloudSelector(url) {
    url = encodeURI(url);
    return document.getElementById(url).querySelector('.leancloud-visitors-count');
  }
  if (CONFIG.page.isPost) {
    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.getAttribute('id'));
      var title = visitors.getAttribute('data-flag-title');

      Counter('get', `/classes/Counter?where=${JSON.stringify({ url })}`)
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .then(response => response.json())
              .then(() => {
                leancloudSelector(url).innerText = counter.time + 1;
              })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              })
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }
  } else {
    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.getAttribute('id'));
      });

      Counter('get', `/classes/Counter?where=${JSON.stringify({ url: { '$in': entries } })}`)
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length === 0) {
            document.querySelectorAll('.leancloud_visitors .leancloud-visitors-count').forEach(element => {
              element.innerText = 0;
            });
            return;
          }
          for (let item of results) {
            let { url, time } = item;
            leancloudSelector(url).innerText = time;
          }
          for (let url of entries) {
            var element = leancloudSelector(url);
            if (element.innerText == '') {
              element.innerText = 0;
            }
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }
  }

  fetch('https://app-router.leancloud.cn/2/route?appId=a05sUJqbxBXDbnppdO8OVgiC-gzGzoHsz')
    .then(response => response.json())
    .then(({ api_server }) => {
      var Counter = (method, url, data) => {
        return fetch(`https://${api_server}/1.1${url}`, {
          method: method,
          headers: {
            'X-LC-Id': 'a05sUJqbxBXDbnppdO8OVgiC-gzGzoHsz',
            'X-LC-Key': 'YRcXfwqMVEWtFfgTumCdt2il',
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    });
  </script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el: '#valine-comments',
      verify: false,
      notify: false,
      appId: 'a05sUJqbxBXDbnppdO8OVgiC-gzGzoHsz',
      appKey: 'YRcXfwqMVEWtFfgTumCdt2il',
      placeholder: "Just go go",
      avatar: 'mm',
      meta: guest,
      pageSize: '10' || 10,
      visitor: false,
      lang: 'zh-cn' || 'zh-cn',
      path: location.pathname,
      recordIP: false,
      serverURLs: ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
